<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>注册</title>
</head>
<body>

用户名：<input type="text" id="username"><br><br>
密码： <input type="password" id="password"><br><br>
<button id="register">注册</button>
</body>
<script src="jquery-1.12.4.js"></script>
<script>
  var username = '';
  var password = '';
  var users = {};
  $.get('http://dao.sinicnet.cn:5000/getUser',{},function (res) {
    console.log(res)
    users = res.data
  })

  $('#username').blur(function () {
    for (var i = 0; i < users.length; i++) {
      if(users[i].name == $(this).val().trim()) {
        alert('用户名已存在')
        $('#username').val('')
        return
      }
    }
    username = $(this).val().trim()
  })

  $('#password').blur(function () {
    password = $(this).val().trim()
  })

  $('#register').click(function () {
    $.post('http://dao.sinicnet.cn:5000/signup',
      {name: username, password: password},
      function (res) {
        if(!username) {
          alert('用户名不能为空');
          return;
        }
        if(!password) {
          alert('密码不能为空');
          return;
        }
        console.log(res)
        if(res.code == 200){
          alert('注册成功');
          location.href = 'http://localhost:63342/songyu/login.html'
        } else {
          alert('注册失败')
          $('#username').val('')
          $('#password').val('')
        }
      }
    )
  })
</script>
</html>